# Tests

We have written tests for:

- C++ code, using [QtTest](https://doc.qt.io/qt-5/qttest-index.html)

    These tests can be run by:
    ```sh
    make cpp
    ```
    This will suppress CMake build messages. If you wish to see the messages
    (for example if the build fails), run `make build`.

- CLI, using [BATS](https://github.com/bats-core/bats-core)

    These tests can be run by:
    ```sh
    make -C ..
    make cli
    ```
    Note: *The first line builds the `devconf` executable.*

All tests can be run at once with the following commands:
```sh
make -C ..
make
```

## Notes

The CLI tests test the `--template` option and the `--input-dir` and
`--output-dir` options, but only whether all the output files are there. The
files' contents are not tested -- that must be done manually.

The output files after running the CLI tests will be located in `_out/out_dir/`.

You can run `./setup_mbed` to create an `_mbed/` directory and set up an mbed
workspace there using [*Mbed CLI*](https://pypi.org/project/mbed-cli/). This
will also copy the mbed workspace files generated by the CLI tests there. All
the tests operate on the JSON and C++ files for a smart light device. You
can implement basic smart light functionality and flash it onto an actual
device by running `./compile`.

While testing, you are advised to make use of the documentation for the
communication protocol [here](https://siau-devconf.readthedocs.io/en/latest/communication.html).
